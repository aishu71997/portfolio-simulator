<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Trading Simulation</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #44065c;
            color: #333;
            background-image: url('https://images.unsplash.com/photo-1579546929662-711aa8c84923?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D');
            background-size: cover;
            background-position: center;
            backdrop-filter: blur(5px);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: rgba(48, 199, 236, 0.8);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

         h2, h3 {
            color: #0d0d0e;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        h1 {
            color: #dee6ee;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }
        header {
            background-color: rgba(44, 62, 80, 0.7);
            color: #fff;
            padding: 25px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        header img {
            height: 60px;
            margin-right: 15px;
        }

        header h1 {
            margin: 0;
            font-size: 3rem;
            font-family: 'Press Start 2P', cursive;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .tabs {
            display: flex;
            background-color: #3498db;
            overflow: hidden;
            border-radius: 5px;
            margin-top: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .tabs button {
            flex: 1;
            padding: 18px;
            background-color: inherit;
            border: none;
            color: #fff;
            font-size: 1.2rem;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            font-family: 'Press Start 2P', cursive;
        }

        .tabs button:hover {
            background-color: #2980b9;
            transform: scale(1.05);
        }

        .tabs button.active {
            background-color: #1e70bf;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .tab-content {
            display: none;
            padding: 30px;
            background-color: rgba(255, 255, 255, 0.9);
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 10px;
            margin-top: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .tab-content.active {
            display: block;
        }

        .auth-form, .calculator-form, .profile-form {
            max-width: 500px;
            margin: 0 auto;
            padding: 30px;
            background-color: rgba(236, 240, 241, 0.8);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .auth-form input, .calculator-form input, .profile-form input {
            width: 100%;
            padding: 12px;
            margin: 15px 0;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            transition: border-color 0.3s;
            font-size: 1.1rem;
        }

        .auth-form input:focus, .calculator-form input:focus, .profile-form input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .auth-form button, .calculator-form button, .profile-form button {
            width: 100%;
            padding: 14px;
            background-color: #3498db;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            font-size: 1.2rem;
            font-family: 'Press Start 2P', cursive;
        }

        .auth-form button:hover, .calculator-form button:hover, .profile-form button:hover {
            background-color: #217dbb;
            transform: scale(1.05);
        }

        .stock-prices {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stock-card {
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .stock-card:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }

        .stock-card h3 {
            margin: 0 0 10px 0;
            font-size: 1.5rem;
            color: #2c3e50;
        }

        .stock-card p {
            margin: 5px 0;
            font-size: 1.2rem;
            color: #7f8c8d;
        }

        footer {
            background-color: rgba(44, 62, 80, 0.7);
            color: #fff;
            text-align: center;
            padding: 25px;
            margin-top: 30px;
            border-top: 1px solid #bdc3c7;
            border-radius: 10px 10px 0 0;
            box-shadow: 0 -2px 4px rgba(0,0,0,0.1);
        }

        footer p {
            margin: 0;
            font-size: 1.1rem;
        }

        .hidden {
            display: none;
        }

        .transaction-history {
            margin-top: 30px;
        }

        .transaction-history table {
            width: 100%;
            border-collapse: collapse;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .transaction-history th, .transaction-history td {
            padding: 15px;
            border-bottom: 1px solid #ddd;
            text-align: center;
            font-size: 1.1rem;
        }

        .transaction-history th {
            background-color: #3498db;
            color: #fff;
            font-weight: bold;
            font-family: 'Press Start 2P', cursive;
        }

        .transaction-history td {
            color: #555;
        }

        .profile-info {
            margin-top: 30px;
            padding: 30px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .profile-info p {
            margin: 15px 0;
            font-size: 1.2rem;
            color: #555;
        }

        .profile-info button {
            margin-top: 15px;
            font-size: 1.2rem;
            color: #3aace0;
        }

        .calculator-section {
            margin-top: 30px;
            padding: 30px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .charts-section canvas {
            max-width: 100%;
            height: auto !important;
            margin-bottom: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            background-color: rgba(200, 200, 200, 0.9);
            padding: 10px;
        }

        .error-message {
            color: red;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        /* Responsive Styles */
        @media (max-width: 700px) {
            .container {
                padding: 15px;
            }
            header {
                flex-direction: column;
            }
            header h1 {
                margin-bottom: 10px;
                font-size: 2.5rem;
            }
            .tabs {
                flex-direction: column;
            }
            .tabs button {
                flex: none;
                width: 100%;
                text-align: center;
                padding: 12px;
            }
            .stock-prices {
                grid-template-columns: 1fr;
            }
            .auth-form, .calculator-form, .profile-form {
                padding: 20px;
            }
            .auth-form input, .calculator-form input, .profile-form input {
                padding: 10px;
                font-size: 1rem;
            }
            .auth-form button, .calculator-form button, .profile-form button {
                padding: 12px;
                font-size: 1.1rem;
            }
            .transaction-history th, .transaction-history td {
                padding: 10px;
                font-size: 0.9rem;
            }
            footer {
                padding: 20px;
            }
            header img {
                margin-right: 0;
                margin-bottom: 10px;
            }
        }

        @media (max-width: 480px) {
            header h1 {
                font-size: 2rem;
            }
            .stock-card h3 {
                font-size: 1.2rem;
            }
            .stock-card p {
                font-size: 1rem;
            }
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <img src="image/logo.jpg" alt="TradyNews Logo">
        <h1>Stock Trading Simulation</h1>
        <button id="sign-out-btn" class="hidden">Sign Out</button>
    </header>

    <div class="tabs">
        <button onclick="showTab('dashboard')" class="active">Dashboard</button>
        <button onclick="showTab('charts')">Charts</button>
        <button onclick="showTab('my-account')">My Account</button>
    </div>

    <div id="dashboard" class="tab-content active">
        <h2>Dashboard</h2>
        <div class="stock-prices" id="stock-prices"></div>
    </div>

    <div id="charts" class="tab-content">
        <h2>Charts</h2>
        <div class="charts-section">
            <canvas id="pie-chart"></canvas>
            <canvas id="bar-chart"></canvas>
        </div>
    </div>

    <div id="my-account" class="tab-content">
        <h2>My Account</h2>
        <div class="auth-form" id="login-form">
            <h3>Login</h3>
            <label for="login-email">Email:</label>
            <input type="email" id="login-email" required>
            <label for="login-password">Password:</label>
            <input type="password" id="login-password" required>
            <button id="login-btn">Login</button>
            <button id="show-signup">Sign Up</button>
            <button id="show-forgot-password">Forgot Password?</button>
        </div>
        <div class="auth-form hidden" id="signup-form">
            <h3>Sign Up</h3>
            <label for="signup-email">Email:</label>
            <input type="email" id="signup-email" required>
            <div id="email-error" class="error-message"></div>
            <label for="signup-password">Password:</label>
            <input type="password" id="signup-password" required>
            <div id="password-error" class="error-message"></div>
            <button id="signup-btn">Sign Up</button>
            <button id="show-login">Back to Login</button>
        </div>
        <div class="auth-form hidden" id="forgot-password-form">
            <h3>Forgot Password</h3>
            <label for="forgot-email">Email:</label>
            <input type="email" id="forgot-email" required>
            <button id="recover-btn">Recover Password</button>
            <button id="show-login-from-forgot">Back to Login</button>
        </div>
        <div id="account-details" class="hidden">
            <div class="profile-info">
                <h3>Profile Information</h3>
                <p><strong>Name:</strong> <span id="profile-name"></span></p>
                <p><strong>DOB:</strong> <span id="profile-dob"></span></p>
                <p><strong>Phone:</strong> <span id="profile-phone"></span></p>
                <p><strong>Address:</strong> <span id="profile-address"></span></p>
                <p><strong>Email:</strong> <span id="profile-email"></span></p>
                <p><strong>Cash Balance:</strong> $<span id="cash-balance">10000</span></p>
                <button id="edit-profile-btn">Edit Profile</button>
                <button id="delete-profile-btn">Delete Profile</button>
                <a href="balance.html">
                    <button id="myBalanceButton">My Balance</button>
                    </a>
            </div>
            <div class="profile-form hidden" id="edit-profile-form">
                <h3>Edit Profile</h3>
                <label for="edit-name">Name:</label>
                <input type="text" id="edit-name" required>
                <label for="edit-dob">Date of Birth:</label>
                <input type="date" id="edit-dob" required>
                <label for="edit-phone">Phone:</label>
                <input type="tel" id="edit-phone" required>
                <label for="edit-address">Address:</label>
                <input type="text" id="edit-address" required>
                <label for="edit-email">Email:</label>
                <input type="email" id="edit-email" required>
                <button id="save-profile-btn">Save Profile</button>
                <button id="cancel-profile-btn">Cancel</button>
            </div>
            <div class="calculator-section">
                <h3>Stock Investment Calculator</h3>
                <form id="calculator-form" class="calculator-form">
                    <label for="stock-select">Select Stock:</label>
                    <select id="stock-select" name="stock">
                        <!-- Stock options remain the same as provided earlier -->
                    </select>
                    <label for="quantity-input">Quantity:</label>
                    <input type="number" id="quantity-input" name="quantity" value="1" min="1">
                    <button id="buy-btn" type="button">Buy</button>
                    <button id="sell-btn" type="button">Sell</button>
                    <p>Transaction Fee: $<span id="transaction-fee">10</span></p>
                    <p>Cash Balance: $<span id="cash-balance">10000</span></p>
                    <p>Portfolio Value: $<span id="portfolio-value">0</span></p>
                    <p>Profit/Loss: $<span id="profit-loss">0</span></p>
                    <p>Asset Allocation: <span id="asset-allocation"></span></p>
                </form>
            </div>
            <div class="transaction-history">
                <h3>Transaction History</h3>
                <table id="transaction-table">
                    <tr>
                        <th>Date</th>
                        <th>Type</th>
                        <th>Stock</th>
                        <th>Quantity</th>
                        <th>Price</th>
                        <th>Total</th>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Stock Trading Simulation created by @ Aishwarya salunkhe</p>
    </footer>

    <script>
        const stocks = {
            AAPL: { name: "Apple", price: 150, history: [150, 152, 155, 154, 156, 158, 160, 159, 162, 165], shares: 0 },
            GOOG: { name: "Google", price: 2700, history: [2700, 2710, 2720, 2715, 2730, 2745, 2760, 2755, 2770, 2785], shares: 0 },
            AMZN: { name: "Amazon", price: 3200, history: [3200, 3215, 3230, 3220, 3240, 3255, 3270, 3265, 3280, 3295], shares: 0 },
            MSFT: { name: "Microsoft", price: 280, history: [280, 282, 285, 284, 286, 288, 290, 289, 292, 295], shares: 0 },
            TSLA: { name: "Tesla", price: 750, history: [750, 755, 760, 758, 765, 770, 775, 772, 780, 785], shares: 0 },
            FB: { name: "Facebook", price: 350, history: [350, 352, 355, 354, 356, 358, 360, 359, 362, 365], shares: 0 },
            JPM: { name: "JPMorgan Chase", price: 160, history: [160, 162, 165, 164, 166, 168, 170, 169, 172, 175], shares: 0 },
            V: { name: "Visa", price: 250, history: [250, 252, 255, 254, 256, 258, 260, 259, 262, 265], shares: 0 },
            PG: { name: "Procter & Gamble", price: 140, history: [140, 142, 145, 144, 146, 148, 150, 149, 152, 155], shares: 0 },
            JNJ: { name: "Johnson & Johnson", price: 170, history: [170, 172, 175, 174, 176, 178, 180, 179, 182, 185], shares: 0 },
            WMT: { name: "Walmart", price: 145, history: [145, 147, 150, 149, 151, 153, 155, 154, 157, 160], shares: 0 },
            BA: { name: "Boeing", price: 220, history: [220, 222, 225, 224, 226, 228, 230, 229, 232, 235], shares: 0 },
            DIS: { name: "Disney", price: 180, history: [180, 182, 185, 184, 186, 188, 190, 189, 192, 195], shares: 0 },
            KO: { name: "Coca-Cola", price: 60, history: [60, 62, 65, 64, 66, 68, 70, 69, 72, 75], shares: 0 },
            PEP: { name: "PepsiCo", price: 155, history: [155, 157, 160, 159, 161, 163, 165, 164, 167, 170], shares: 0 },
            NFLX: { name: "Netflix", price: 550, history: [550, 555, 560, 558, 565, 570, 575, 572, 580, 585], shares: 0 },
            INTC: { name: "Intel", price: 55, history: [55, 56, 57, 56, 58, 59, 60, 59, 61, 62], shares: 0 },
            CMCSA: { name: "Comcast", price: 60, history: [60, 61, 62, 61, 63, 64, 65, 64, 66, 67], shares: 0 },
            CSCO: { name: "Cisco", price: 50, history: [50, 51, 52, 51, 53, 54, 55, 54, 56, 57], shares: 0 },
            ORCL: { name: "Oracle", price: 80, history: [80, 81, 82, 81, 83, 84, 85, 84, 86, 87], shares: 0 },
            ABT: { name: "Abbott Laboratories", price: 120, history: [120, 122, 125, 124, 126, 128, 130, 129, 132, 135], shares: 0 },
            MMM: { name: "3M", price: 180, history: [180, 182, 185, 184, 186, 188, 190, 189, 192, 195], shares: 0 },
            PFE: { name: "Pfizer", price: 45, history: [45, 46, 47, 46, 48, 49, 50, 49, 51, 52], shares: 0 },
            MRK: { name: "Merck", price: 90, history: [90, 92, 95, 94, 96, 98, 100, 99, 102, 105], shares: 0 },
            CVX: { name: "Chevron", price: 150, history: [150, 152, 155, 154, 156, 158, 160, 159, 162, 165], shares: 0 },
            XOM: { name: "ExxonMobil", price: 140, history: [140, 142, 145, 144, 146, 148, 150, 149, 152, 155], shares: 0 },
            GE: { name: "General Electric", price: 100, history: [100, 102, 105, 104, 106, 108, 110, 109, 112, 115], shares: 0 },
            GM: { name: "General Motors", price: 40, history: [40, 41, 42, 41, 43, 44, 45, 44, 46, 47], shares: 0 },
            F: { name: "Ford", price: 15, history: [15, 16, 17, 16, 18, 19, 20, 19, 21, 22], shares: 0 },
            T: { name: "AT&T", price: 30, history: [30, 31, 32, 31, 33, 34, 35, 34, 36, 37], shares: 0 },
            VZ: { name: "Verizon", price: 50, history: [50, 51, 52, 51, 53, 54, 55, 54, 56, 57], shares: 0 },
            IBM: { name: "IBM", price: 130, history: [130, 132, 135, 134, 136, 138, 140, 139, 142, 145], shares: 0 },
            C: { name: "Citigroup", price: 70, history: [70, 72, 75, 74, 76, 78, 80, 79, 82, 85], shares: 0 },
            GS: { name: "Goldman Sachs", price: 380, history: [380, 385, 390, 388, 395, 400, 405, 402, 410, 415], shares: 0 },
            AXP: { name: "American Express", price: 170, history: [170, 172, 175, 174, 176, 178, 180, 179, 182, 185], shares: 0 },
            NKE: { name: "Nike", price: 140, history: [140, 142, 145, 144, 146, 148, 150, 149, 152, 155], shares: 0 },
            MCD: { name: "McDonald's", price: 270, history: [270, 272, 275, 274, 276, 278, 280, 279, 282, 285], shares: 0 },
            HD: { name: "Home Depot", price: 330, history: [330, 335, 340, 338, 345, 350, 355, 352, 360, 365], shares: 0 },
            LOW: { name: "Lowe's", price: 250, history: [250, 252, 255, 254, 256, 258, 260, 259, 262, 265], shares: 0 },
            SBUX: { name: "Starbucks", price: 110, history: [110, 112, 115, 114, 116, 118, 120, 119, 122, 125], shares: 0 },
        };

        let user = {
            name: "",
            dob: "",
            phone: "",
            address: "",
            email: "",
            password: "",
            cashBalance: 10000,
            portfolio: {},
            transactions: []
        };

        let editingProfile = false;
        let pieChartInstance = null;
        let barChartInstance = null;
        let updateIntervalId = null;

        window.onload = function () {
            initializeUI();
            loadDashboard();
            loadCharts();
            startStockUpdates();
            if (localStorage.getItem('user')) {
                user = JSON.parse(localStorage.getItem('user'));
                loadAccountDetails();
                document.getElementById('sign-out-btn').classList.remove('hidden');
                document.getElementById('login-form').classList.add('hidden');
                document.getElementById('signup-form').classList.add('hidden');
                document.getElementById('forgot-password-form').classList.add('hidden');
            }
        };

        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            if (tabId === 'charts') {
                loadCharts();
            }
        }

        function initializeUI() {
            document.getElementById('login-btn').addEventListener('click', login);
            document.getElementById('show-signup').addEventListener('click', () => {
                document.getElementById('login-form').classList.add('hidden');
                document.getElementById('signup-form').classList.remove('hidden');
                document.getElementById('forgot-password-form').classList.add('hidden');
            });
            document.getElementById('show-login').addEventListener('click', () => {
                document.getElementById('login-form').classList.remove('hidden');
                document.getElementById('signup-form').classList.add('hidden');
                document.getElementById('forgot-password-form').classList.add('hidden');
            });
            document.getElementById('show-forgot-password').addEventListener('click', () => {
                document.getElementById('login-form').classList.add('hidden');
                document.getElementById('forgot-password-form').classList.remove('hidden');
                document.getElementById('signup-form').classList.add('hidden');
            });
            document.getElementById('show-login-from-forgot').addEventListener('click', () => {
                document.getElementById('login-form').classList.remove('hidden');
                document.getElementById('forgot-password-form').classList.add('hidden');
            });
            document.getElementById('signup-btn').addEventListener('click', signup);
            document.getElementById('recover-btn').addEventListener('click', recoverPassword);
            document.getElementById('edit-profile-btn').addEventListener('click', showEditProfileForm);
            document.getElementById('save-profile-btn').addEventListener('click', saveProfile);
            document.getElementById('cancel-profile-btn').addEventListener('click', hideEditProfileForm);
            document.getElementById('delete-profile-btn').addEventListener('click', deleteProfile);
            document.getElementById('sign-out-btn').addEventListener('click', signOut);
            document.getElementById('buy-btn').addEventListener('click', () => {
                const stock = document.getElementById('stock-select').value;
                const quantity = parseInt(document.getElementById('quantity-input').value);
                buyStock(stock, quantity);
            });
            document.getElementById('sell-btn').addEventListener('click', () => {
                const stock = document.getElementById('stock-select').value;
                const quantity = parseInt(document.getElementById('quantity-input').value);
                sellStock(stock, quantity);
            });
            document.getElementById('signup-email').addEventListener('input', () => {
                document.getElementById('email-error').textContent = '';
            });
            document.getElementById('signup-password').addEventListener('input', () => {
                document.getElementById('password-error').textContent = '';
            });
        }

        function loadDashboard() {
            const stockPricesDiv = document.getElementById('stock-prices');
            stockPricesDiv.innerHTML = '';
            for (const stock in stocks) {
                const stockData = stocks[stock];
                const stockCard = document.createElement('div');
                stockCard.className = 'stock-card';
                stockCard.innerHTML = `
                    <h3>${stockData.name}</h3>
                    <p>Price: $${stockData.price.toFixed(2)}</p>
                `;
                stockPricesDiv.appendChild(stockCard);
            }
        }

        function loadCharts() {
            const stockNames = Object.keys(stocks);
            const stockPrices = stockNames.map((stock) => stocks[stock].price);
            const historyData = {};
            for (const stock in stocks) {
                historyData[stock] = stocks[stock].history;
            }

            const ctxPie = document.getElementById("pie-chart").getContext("2d");
            if (pieChartInstance) {
                pieChartInstance.destroy();
            }
            pieChartInstance = new Chart(ctxPie, {
                type: "pie",
                data: {
                    labels: stockNames,
                    datasets: [
                        {
                            label: "Stock Prices",
                            data: stockPrices,
                            backgroundColor: [
                                "rgba(255, 99, 132, 0.6)",
                                "rgba(54, 162, 235, 0.6)",
                                "rgba(255, 206, 86, 0.6)",
                                "rgba(75, 192, 192, 0.6)",
                                "rgba(153, 102, 255, 0.6)",
                                "rgba(255, 159, 64, 0.6)",
                                "rgba(255, 0, 0, 0.6)",
                                "rgba(0, 255, 0, 0.6)",
                                "rgba(0, 0, 255, 0.6)",
                                "rgba(128, 128, 0, 0.6)",
                                "rgba(100, 149, 237, 0.6)",
                                "rgba(218, 112, 214, 0.6)",
                                "rgba(32, 178, 170, 0.6)",
                                "rgba(255, 215, 0, 0.6)",
                                "rgba(220, 20, 60, 0.6)",
                                "rgba(240, 128, 128, 0.6)",
                                "rgba(173, 216, 230, 0.6)",
                                "rgba(244, 164, 96, 0.6)",
                                "rgba(144, 238, 144, 0.6)",
                                "rgba(138, 43, 226, 0.6)",
                                "rgba(255, 160, 122, 0.6)",
                                "rgba(199, 21, 133, 0.6)",
                                "rgba(0, 255, 255, 0.6)",
                                "rgba(255, 255, 0, 0.6)",
                                "rgba(128, 0, 0, 0.6)",
                                "rgba(0, 128, 0, 0.6)",
                                "rgba(0, 128, 128, 0.6)",
                                "rgba(0, 0, 128, 0.6)",
                                "rgba(192, 192, 192, 0.6)",
                                "rgba(255, 228, 181, 0.6)",
                                "rgba(255, 235, 205, 0.6)",
                                "rgba(176, 196, 222, 0.6)",
                                "rgba(255, 240, 245, 0.6)",
                            ],
                            borderWidth: 1,
                        },
                    ],
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: "top",
                        },
                        title: {
                            display: true,
                            text: "Current Stock Prices",
                            font: {
                                size: 16,
                            },
                        },
                    },
                },
            });

            const ctxBar = document.getElementById("bar-chart").getContext("2d");
            if (barChartInstance) {
                barChartInstance.destroy();
            }
            barChartInstance = new Chart(ctxBar, {
                type: "bar",
                data: {
                    labels: [
                        "Day 1",
                        "Day 2",
                        "Day 3",
                        "Day 4",
                        "Day 5",
                        "Day 6",
                        "Day 7",
                        "Day 8",
                        "Day 9",
                        "Day 10",
                    ],
                    datasets: Object.keys(historyData).map((stock, index) => ({
                        label: stocks[stock].name,
                        data: historyData[stock],
                        backgroundColor: [
                            "rgba(255, 99, 132, 0.6)",
                            "rgba(54, 162, 235, 0.6)",
                            "rgba(255, 206, 86, 0.6)",
                            "rgba(75, 192, 192, 0.6)",
                            "rgba(153, 102, 255, 0.6)",
                            "rgba(255, 159, 64, 0.6)",
                            "rgba(255, 0, 0, 0.6)",
                            "rgba(0, 255, 0, 0.6)",
                            "rgba(0, 0, 255, 0.6)",
                            "rgba(128, 128, 0, 0.6)",
                            "rgba(100, 149, 237, 0.6)",
                            "rgba(218, 112, 214, 0.6)",
                            "rgba(32, 178, 170, 0.6)",
                            "rgba(255, 215, 0, 0.6)",
                            "rgba(220, 20, 60, 0.6)",
                            "rgba(240, 128, 128, 0.6)",
                            "rgba(173, 216, 230, 0.6)",
                            "rgba(244, 164, 96, 0.6)",
                            "rgba(144, 238, 144, 0.6)",
                            "rgba(138, 43, 226, 0.6)",
                            "rgba(255, 160, 122, 0.6)",
                            "rgba(199, 21, 133, 0.6)",
                            "rgba(0, 255, 255, 0.6)",
                            "rgba(255, 255, 0, 0.6)",
                            "rgba(128, 0, 0, 0.6)",
                            "rgba(0, 128, 0, 0.6)",
                            "rgba(0, 128, 128, 0.6)",
                            "rgba(0, 0, 128, 0.6)",
                            "rgba(192, 192, 192, 0.6)",
                            "rgba(255, 228, 181, 0.6)",
                            "rgba(255, 235, 205, 0.6)",
                            "rgba(176, 196, 222, 0.6)",
                            "rgba(255, 240, 245, 0.6)",
                        ][index % 33],
                        borderWidth: 1,
                    })),
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: "Stock Price History (Last 10 Days)",
                            font: {
                                size: 16,
                            },
                        },
                        legend: {
                            position: "bottom",
                        },
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                        },
                    },
                },
            });
        }

        function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            if (email === user.email && password === user.password) {
                document.getElementById('login-form').classList.add('hidden');
                document.getElementById('account-details').classList.remove('hidden');
                document.getElementById('sign-out-btn').classList.remove('hidden');
                loadAccountDetails();
                localStorage.setItem('user', JSON.stringify(user));
                alert('Logged in successfully!');
            } else {
                alert('Invalid credentials. Please try again.');
            }
        }

        function signup() {
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;

            if (!isValidEmail(email)) {
                document.getElementById('email-error').textContent = "Please enter a valid email address.";
                return;
            } else {
                document.getElementById('email-error').textContent = "";
            }

            if (password.length < 6) {
                document.getElementById('password-error').textContent = "Password must be at least 6 characters long.";
                return;
            } else {
                document.getElementById('password-error').textContent = "";
            }

            if (!user.email) {
                user.email = email;
                user.password = password;
                alert('Signed up successfully! Please log in.');
                document.getElementById('signup-form').classList.add('hidden');
                document.getElementById('login-form').classList.remove('hidden');
                localStorage.setItem('user', JSON.stringify(user));
            } else {
                alert('Email already exists. Please log in.');
            }
        }

        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function recoverPassword() {
            const email = document.getElementById('forgot-email').value;
            if (email === user.email) {
                alert('Password reset email sent to ' + email + '.');
                document.getElementById('forgot-password-form').classList.add('hidden');
                document.getElementById('login-form').classList.remove('hidden');
            } else {
                alert('Email not found.');
            }
        }

        function loadAccountDetails() {
            document.getElementById('profile-name').textContent = user.name;
            document.getElementById('profile-dob').textContent = user.dob;
            document.getElementById('profile-phone').textContent = user.phone;
            document.getElementById('profile-address').textContent = user.address;
            document.getElementById('profile-email').textContent = user.email;
            document.getElementById('cash-balance').textContent = user.cashBalance.toFixed(2);
            let portfolioValue = 0;
            for (const stock in user.portfolio) {
                portfolioValue += stocks[stock].price * user.portfolio[stock];
            }
            document.getElementById('portfolio-value').textContent = portfolioValue.toFixed(2);
            let totalCost = 0;
            let totalShares = 0;
            for (const transaction of user.transactions) {
                if (transaction.type === 'Buy') {
                    totalCost += transaction.total;
                    totalShares += transaction.quantity;
                } else if (transaction.type === 'Sell') {
                    totalCost -= transaction.total;
                    totalShares -= transaction.quantity;
                }
            }
            let profitLoss = portfolioValue + user.cashBalance - 10000;
            document.getElementById('profit-loss').textContent = profitLoss.toFixed(2);
            updateTransactionHistory();
            document.getElementById('stock-select').innerHTML = Object.keys(stocks)
                .map(stock => `<option value="${stock}">${stocks[stock].name} (${stock})</option>`)
                .join('');
            updateAssetAllocation();
        }

        function showEditProfileForm() {
            editingProfile = true;
            document.getElementById('edit-profile-form').classList.remove('hidden');
            document.getElementById('profile-info').classList.add('hidden');

            document.getElementById('edit-name').value = user.name;
            document.getElementById('edit-dob').value = user.dob;
            document.getElementById('edit-phone').value = user.phone;
            document.getElementById('edit-address').value = user.address;
            document.getElementById('edit-email').value = user.email;
        }

        function saveProfile() {
            if (editingProfile) {
                user.name = document.getElementById('edit-name').value;
                user.dob = document.getElementById('edit-dob').value;
                user.phone = document.getElementById('edit-phone').value;
                user.address = document.getElementById('edit-address').value;
                user.email = document.getElementById('edit-email').value;

                document.getElementById('edit-profile-form').classList.add('hidden');
                document.getElementById('profile-info').classList.remove('hidden');
                loadAccountDetails();
                localStorage.setItem('user', JSON.stringify(user));
                editingProfile = false;
            }
        }

        function hideEditProfileForm() {
            editingProfile = false;
            document.getElementById('edit-profile-form').classList.add('hidden');
            document.getElementById('profile-info').classList.remove('hidden');
        }

        function deleteProfile() {
            const confirmation = confirm("Are you sure you want to delete your profile?");
            if (confirmation) {
                user = {
                    name: "",
                    dob: "",
                    phone: "",
                    address: "",
                    email: "",
                    password: "",
                    cashBalance: 10000,
                    portfolio: {},
                    transactions: []
                };
                localStorage.removeItem('user');
                document.getElementById('account-details').classList.add('hidden');
                document.getElementById('login-form').classList.remove('hidden');
                document.getElementById('sign-out-btn').classList.add('hidden');
                loadDashboard();
                alert("Profile deleted. You have been signed out.");
            }
        }

        function signOut() {
            user = {
                name: "",
                dob: "",
                phone: "",
                address: "",
                email: "",
                password: "",
                cashBalance: 10000,
                portfolio: {},
                transactions: []
            };
            localStorage.removeItem('user');
            document.getElementById('account-details').classList.add('hidden');
            document.getElementById('login-form').classList.remove('hidden');
            document.getElementById('sign-out-btn').classList.add('hidden');
            loadDashboard();
            alert("Signed out.");
        }

        function buyStock(stockName, quantity) {
            const stock = stocks[stockName];
            const cost = stock.price * quantity + 10;
            if (user.cashBalance >= cost) {
                user.cashBalance -= cost;
                user.portfolio[stockName] = (user.portfolio[stockName] || 0) + quantity;
                const transaction = {
                    date: new Date().toLocaleDateString(),
                    type: "Buy",
                    stock: stockName,
                    quantity: quantity,
                    price: stock.price,
                    total: cost
                };
                user.transactions.push(transaction);
                stocks[stockName].shares += quantity;
                loadAccountDetails();
                localStorage.setItem('user', JSON.stringify(user));
                alert(`Bought ${quantity} shares of ${stock.name} (${stockName})`);
            } else {
                alert('Insufficient funds.');
            }
        }

        function sellStock(stockName, quantity) {
            const stock = stocks[stockName];
            const revenue = stock.price * quantity - 10;
            if (user.portfolio[stockName] >= quantity) {
                user.cashBalance += revenue;
                user.portfolio[stockName] -= quantity;
                if (user.portfolio[stockName] === 0) {
                    delete user.portfolio[stockName];
                }
                const transaction = {
                    date: new Date().toLocaleDateString(),
                    type: "Sell",
                    stock: stockName,
                    quantity: quantity,
                    price: stock.price,
                    total: revenue
                };
                user.transactions.push(transaction);
                stocks[stockName].shares -= quantity;
                loadAccountDetails();
                localStorage.setItem('user', JSON.stringify(user));
                alert(`Sold ${quantity} shares of ${stock.name} (${stockName})`);
            } else {
                alert('Not enough shares.');
            }
        }

        function updateTransactionHistory() {
            const transactionTable = document.getElementById('transaction-table');
            transactionTable.innerHTML = `
                <tr>
                    <th>Date</th>
                    <th>Type</th>
                    <th>Stock</th>
                    <th>Quantity</th>
                    <th>Price</th>
                    <th>Total</th>
                </tr>
            `;
            user.transactions.forEach(transaction => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${transaction.date}</td>
                    <td>${transaction.type}</td>
                    <td>${transaction.stock}</td>
                    <td>${transaction.quantity}</td>
                    <td>$${transaction.price.toFixed(2)}</td>
                    <td>$${transaction.total.toFixed(2)}</td>
                `;
                transactionTable.appendChild(row);
            });
        }

        function startStockUpdates() {
            updateIntervalId = setInterval(() => {
                for (const stock in stocks) {
                    const priceChange = (Math.random() - 0.5) * 10;
                    stocks[stock].price += priceChange;
                    if (stocks[stock].price < 0) stocks[stock].price = 1;
                    stocks[stock].history.push(stocks[stock].price);
                    stocks[stock].history = stocks[stock].history.slice(-10);
                }
                loadDashboard();
                loadCharts();
                if (localStorage.getItem('user')) {
                    loadAccountDetails();
                }
            }, 5000);
        }

        function stopStockUpdates() {
            clearInterval(updateIntervalId);
        }

        function updateAssetAllocation() {
            let totalPortfolioValue = 0;
            for (const stock in user.portfolio) {
                totalPortfolioValue += stocks[stock].price * user.portfolio[stock];
            }

            let allocationString = "";
            if (totalPortfolioValue > 0) {
                for (const stock in user.portfolio) {
                    const stockValue = stocks[stock].price * user.portfolio[stock];
                    const percentage = ((stockValue / totalPortfolioValue) * 100).toFixed(2);
                    allocationString += `${stocks[stock].name}: ${percentage}%, `;
                }
                allocationString = allocationString.slice(0, -2);
            } else {
                allocationString = "No assets in portfolio.";
            }

            document.getElementById("asset-allocation").textContent = allocationString;
        }

        window.onbeforeunload = function() {
            stopStockUpdates();
            if (localStorage.getItem('user')) {
                localStorage.setItem('user', JSON.stringify(user));
            }
        };
    </script>
</body>
</html>